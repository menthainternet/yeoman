<!DOCTYPE html>  <html> <head>   <title>css.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="css.html">                 css.js               </a>                                           <a class="source" href="docs.html">                 docs.js               </a>                                           <a class="source" href="dom.html">                 dom.js               </a>                                           <a class="source" href="h5bp.html">                 h5bp.js               </a>                                           <a class="source" href="html.html">                 html.js               </a>                                           <a class="source" href="img.html">                 img.js               </a>                                           <a class="source" href="h5bp.html">                 h5bp.js               </a>                                           <a class="source" href="gruntfile.html">                 gruntfile.js               </a>                                           <a class="source" href="main.html">                 main.js               </a>                                           <a class="source" href="plugins.html">                 plugins.js               </a>                                           <a class="source" href="jquery-1.7.2.html">                 jquery-1.7.2.js               </a>                                           <a class="source" href="misc.html">                 misc.js               </a>                                           <a class="source" href="rev.html">                 rev.js               </a>                                           <a class="source" href="serve.html">                 serve.js               </a>                                           <a class="source" href="usemin.html">                 usemin.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               css.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">),</span>
  <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">),</span>
  <span class="nx">cleanCSS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;clean-css&quot;</span><span class="p">),</span>
  <span class="nx">rjs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;requirejs&#39;</span><span class="p">);</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">grunt</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p><em>*css</em> task works pretty much the same as grunt's min task. The task
target is the destination, data is an array of glob patterns. These
files are concataned and run through requirejs optimizer to handle
@import inlines in CSS files.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">grunt</span><span class="p">.</span><span class="nx">task</span><span class="p">.</span><span class="nx">registerMultiTask</span><span class="p">(</span><span class="s1">&#39;css&#39;</span><span class="p">,</span> <span class="s1">&#39;Concats, replaces @imports and minifies the CSS files&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">requiresConfig</span><span class="p">(</span><span class="s1">&#39;staging&#39;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>if defined, files get prepended by the output config value</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">files</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>concat css files matching the glob patterns and write to destination</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">grunt</span><span class="p">.</span><span class="nx">file</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span> <span class="nx">grunt</span><span class="p">.</span><span class="nx">helper</span><span class="p">(</span><span class="s1">&#39;mincss&#39;</span><span class="p">,</span> <span class="nx">files</span><span class="p">,</span> <span class="p">{</span> <span class="nx">nocompress</span><span class="o">:</span> <span class="kc">true</span> <span class="p">}));</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>replace @import statements</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">grunt</span><span class="p">.</span><span class="nx">helper</span><span class="p">(</span><span class="s1">&#39;rjs:optimize:css&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">async</span><span class="p">());</span>
  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p><strong>mincss</strong> basic utility to concat CSS files and run them through
<a href="https://github.com/GoalSmashers/clean-css">cleanCSS</a>, might opt to use
[https://github.com/jzaefferer/grunt-css] plugin.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerHelper</span><span class="p">(</span><span class="s1">&#39;mincss&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">files</span><span class="p">,</span> <span class="nx">o</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">o</span> <span class="o">=</span> <span class="nx">o</span> <span class="o">||</span> <span class="p">{};</span>
    <span class="nx">files</span> <span class="o">=</span> <span class="nx">grunt</span><span class="p">.</span><span class="nx">file</span><span class="p">.</span><span class="nx">expandFiles</span><span class="p">(</span><span class="nx">files</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">files</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">filepath</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">content</span> <span class="o">=</span> <span class="nx">grunt</span><span class="p">.</span><span class="nx">file</span><span class="p">.</span><span class="nx">read</span><span class="p">(</span><span class="nx">filepath</span><span class="p">);</span>
      <span class="k">return</span> <span class="nx">o</span><span class="p">.</span><span class="nx">nocompress</span> <span class="o">?</span> <span class="nx">content</span> <span class="o">:</span> <span class="nx">cleanCSS</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span><span class="nx">content</span><span class="p">);</span>
    <span class="p">}).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p><strong>rjs:optimize:css</strong> is an helper using rjs to optimize a single file,
mainly to properly import multi-level of @import statements, which can be
tricky with all the url rewrites.</p>

<p>file     - Path to the css file to optimize
options  - (optional) rjs configuration
cb       - callback function to call on completion</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerHelper</span><span class="p">(</span><span class="s1">&#39;rjs:optimize:css&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">file</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">cb</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">cb</span><span class="p">)</span> <span class="p">{</span> <span class="nx">cb</span> <span class="o">=</span> <span class="nx">options</span><span class="p">;</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{};</span> <span class="p">}</span>
    <span class="nx">options</span><span class="p">.</span><span class="nx">cssIn</span> <span class="o">=</span> <span class="nx">file</span><span class="p">;</span>
    <span class="nx">options</span><span class="p">.</span><span class="nx">out</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">out</span> <span class="o">||</span> <span class="nx">file</span><span class="p">;</span>
    <span class="nx">options</span><span class="p">.</span><span class="nx">optimizeCss</span> <span class="o">=</span> <span class="s1">&#39;standard.keepLines&#39;</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">before</span> <span class="o">=</span> <span class="nx">grunt</span><span class="p">.</span><span class="nx">file</span><span class="p">.</span><span class="nx">read</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span>
    <span class="nx">rjs</span><span class="p">.</span><span class="nx">optimize</span><span class="p">(</span><span class="nx">options</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">grunt</span><span class="p">.</span><span class="nx">helper</span><span class="p">(</span><span class="s1">&#39;min_max_info&#39;</span><span class="p">,</span> <span class="nx">grunt</span><span class="p">.</span><span class="nx">file</span><span class="p">.</span><span class="nx">read</span><span class="p">(</span><span class="nx">file</span><span class="p">),</span> <span class="nx">before</span><span class="p">);</span>
      <span class="nx">cb</span><span class="p">();</span>
    <span class="p">});</span>
  <span class="p">});</span>

<span class="p">};</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 